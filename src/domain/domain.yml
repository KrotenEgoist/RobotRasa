version: "3.1"

intents:
  - action
  - directions
  - objects
  - action+directions
  - action+objects
  - patrol
  - routes
  - patrol+routes
  - simple_action
  - wrong_command
  - repeat_command

entities:
  - action:
      roles:
        - analyze
        - around
        - find
        - follow
        - monitor
        - move
        - rotate
        - patrol
        - stop
  - subject:
      roles:
        - direction
        - object
        - addition
  - route:
      roles:
        - circle
        - path
  - distance
  - relation
  - number
  - ordinal


slots:
  action:
    type: text
    mappings:
      - type: from_entity
        entity: action
        role: analyze
      - type: from_entity
        entity: action
        role: around
      - type: from_entity
        entity: action
        role: find
      - type: from_entity
        entity: action
        role: follow
      - type: from_entity
        entity: action
        role: monitor
      - type: from_entity
        entity: action
        role: move
      - type: from_entity
        entity: action
        role: rotate
      - type: from_entity
        entity: action
        role: patrol
      - type: from_entity
        entity: action
        role: stop

  subject:
    type: text
    mappings:
      - type: from_entity
        entity: subject
        role: direction
      - type: from_entity
        entity: subject
        role: object

  relation:
    type: list
    mappings:
      - type: from_entity
        entity: relation

  addition:
    type: list
    mappings:
      - type: from_entity
        entity: subject
        role: addition

  distance:
    type: text
    mappings:
      - type: from_entity
        entity: distance

  feature:
    type: text
    mappings:
      - type: from_text
        conditions:
          - active_loop: feature_form
            requested_slot: feature

  route:
    type: text
    mappings:
      - type: from_entity
        entity: route
        role: circle
      - type: from_entity
        entity: route
        role: path

  num:
    type: text
    mappings:
      - type: from_entity
        entity: number
      - type: from_entity
        entity: ordinal

forms:
  subject_form:
    required_slots:
      - subject
  relation_form:
    required_slots:
      - relation
  distance_form:
    required_slots:
      - distance
  feature_form:
    required_slots:
      - feature
  route_form:
    required_slots:
      - route
  num_form:
    required_slots:
      - num

responses:
  utter_wrong_command:
    - text: "Исправляем команду"
  utter_rephrase:
    - text: "Перефразируйте"

  utter_ask_distance:
    - text: "Укажите расстояние"
  utter_ask_relation:
    - text: "Укажите местоположение объекта"
  utter_ask_route:
    - text: "Укажите путь патрулирования"

actions:
  - action_fix_command
  - action_repeat_command
  - action_send_command
  - action_ask_feature
  - action_ask_subject
  - action_ask_num
  - action_reset_slots


session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
